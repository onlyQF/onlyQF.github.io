<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"onlyqf.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.12.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":"ture","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="一：debugger c++ ros2  in vscodea method to debug a C++ node usign VSCode on ROS2 Foxy (Ubuntu).  Compile your C++ package with the symbols:  12colcon build --symlink-install --cmake-args -DCMAKE_BUILD_">
<meta property="og:type" content="article">
<meta property="og:title" content="ROS2 Notes">
<meta property="og:url" content="https://onlyqf.github.io/2022/06/01/ROS2-Notes/index.html">
<meta property="og:site_name" content="Jason Qi&#39;s Blog">
<meta property="og:description" content="一：debugger c++ ros2  in vscodea method to debug a C++ node usign VSCode on ROS2 Foxy (Ubuntu).  Compile your C++ package with the symbols:  12colcon build --symlink-install --cmake-args -DCMAKE_BUILD_">
<meta property="og:locale">
<meta property="article:published_time" content="2022-06-02T02:44:57.000Z">
<meta property="article:modified_time" content="2022-06-02T14:45:29.533Z">
<meta property="article:author" content="Jason Qi">
<meta property="article:tag" content="Jason Blog">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://onlyqf.github.io/2022/06/01/ROS2-Notes/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-Hans","comments":true,"permalink":"https://onlyqf.github.io/2022/06/01/ROS2-Notes/","path":"2022/06/01/ROS2-Notes/","title":"ROS2 Notes"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ROS2 Notes | Jason Qi's Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Jason Qi's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">You make yourself great!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%EF%BC%9Adebugger-c-ros2-in-vscode"><span class="nav-number">1.</span> <span class="nav-text">一：debugger c++ ros2  in vscode</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%EF%BC%9A-%E7%BC%96%E5%86%99%E5%8F%91%E5%B8%83%E8%80%85%E8%8A%82%E7%82%B9%E4%BB%A3%E7%A0%81"><span class="nav-number">1.1.</span> <span class="nav-text">1： 编写发布者节点代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%EF%BC%9A%E4%BF%AE%E6%94%B9Cmakelists-txt%E5%92%8CpackageXML%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.</span> <span class="nav-text">2：修改Cmakelists.txt和packageXML文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%EF%BC%9A%E7%AE%80%E5%8D%95%E7%9A%84ros2%E8%AE%A2%E9%98%85%E8%80%85%E8%8A%82%E7%82%B9%E7%9A%84%E6%92%B0%E5%86%99"><span class="nav-number">2.</span> <span class="nav-text">三：简单的ros2订阅者节点的撰写</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%EF%BC%9A%E7%BC%96%E5%86%99%E8%AE%A2%E9%98%85%E8%80%85%E8%8A%82%E7%82%B9%E4%BB%A3%E7%A0%81"><span class="nav-number">2.1.</span> <span class="nav-text">1：编写订阅者节点代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%EF%BC%9A%E4%BF%AE%E6%94%B9Cmakelists-txt%E5%92%8CpackageXML%E6%96%87%E4%BB%B6-1"><span class="nav-number">2.2.</span> <span class="nav-text">2：修改Cmakelists.txt和packageXML文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%EF%BC%9A-%E6%B3%A8%EF%BC%9A"><span class="nav-number">2.3.</span> <span class="nav-text">3： 注：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%EF%BC%9A%E7%BC%96%E5%86%99-srv%E6%96%87%E4%BB%B6%EF%BC%8C%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.</span> <span class="nav-text">四：编写.srv文件，实现服务类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%EF%BC%9A-srv%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="nav-number">3.1.</span> <span class="nav-text">1： srv文件格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%EF%BC%9A%E4%BF%AE%E6%94%B9Cmakelists-txt%E5%92%8CpackageXML%E6%96%87%E4%BB%B6-2"><span class="nav-number">3.2.</span> <span class="nav-text">2：修改Cmakelists.txt和packageXML文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%EF%BC%9A-srv%E8%8A%82%E7%82%B9%E7%9A%84%E4%BB%A3%E7%A0%81%E7%9A%84%E7%BC%96%E5%86%99"><span class="nav-number">3.3.</span> <span class="nav-text">3： srv节点的代码的编写</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%EF%BC%9Aclient%E7%AB%AF%E4%BB%A3%E7%A0%81%E7%9A%84%E7%BC%96%E5%86%99"><span class="nav-number">3.4.</span> <span class="nav-text">4：client端代码的编写</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5%EF%BC%9ACmakelsts-txt%E5%92%8CpackageXML%E6%96%87%E4%BB%B6%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="nav-number">3.5.</span> <span class="nav-text">5：Cmakelsts.txt和packageXML文件的修改</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%EF%BC%9A-msg%E6%96%87%E4%BB%B6%E7%9A%84%E7%BC%96%E5%86%99"><span class="nav-number">4.</span> <span class="nav-text">五：.msg文件的编写</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%EF%BC%9A%E5%9C%A8WS%E4%B8%8Bsrc"><span class="nav-number">4.1.</span> <span class="nav-text">1：在WS下src;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%88%9B%E5%BB%BAmsg%E5%8C%85%EF%BC%8C%E6%96%B0%E5%BB%BAmsg%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-number">4.2.</span> <span class="nav-text">2:创建msg包，新建msg文件夹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%88%9B%E5%BB%BAmsg%E6%96%87%E4%BB%B6"><span class="nav-number">4.3.</span> <span class="nav-text">3:创建msg文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%EF%BC%9A%E4%BF%AE%E6%94%B9Cmakelists%E5%92%8CpackageXML%E6%96%87%E4%BB%B6"><span class="nav-number">4.4.</span> <span class="nav-text">4：修改Cmakelists和packageXML文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5%EF%BC%9A%E5%9C%A8%E5%85%B6%E4%BB%96%E5%8C%85%E9%87%8C%E9%9D%A2%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89msg"><span class="nav-number">4.5.</span> <span class="nav-text">5：在其他包里面使用自定义msg</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%8C%85%E4%BE%9D%E8%B5%96%E5%85%B6%E4%BB%96%E5%8C%85%E4%B8%BE%E4%BE%8B"><span class="nav-number">5.</span> <span class="nav-text">六：创建包依赖其他包举例</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%EF%BC%9A%E6%96%87%E4%BB%B6%E7%BB%84%E7%BB%87%E5%88%86%E5%B8%83"><span class="nav-number">5.1.</span> <span class="nav-text">1 ：文件组织分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-sm-node-%E5%8C%85%E4%BE%9D%E8%B5%96%E5%85%B6%E4%BB%96%E5%9B%9B%E4%B8%AA%E5%8C%85"><span class="nav-number">5.2.</span> <span class="nav-text">2 :sm_node 包依赖其他四个包</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%83%EF%BC%9Alaunch-%E6%96%87%E4%BB%B6%E4%BD%BF%E7%94%A8"><span class="nav-number">6.</span> <span class="nav-text">七：launch 文件使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%EF%BC%9ACreate-a-new-directory-to-store-your-launch-file"><span class="nav-number">6.1.</span> <span class="nav-text">1：Create a new directory to store your launch file:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%EF%BC%9A%E5%88%9B%E5%BB%BAlaunch-py%E6%96%87%E4%BB%B6"><span class="nav-number">6.2.</span> <span class="nav-text">2：创建launch.py文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E6%96%87%E4%BB%B6%E8%A7%A3%E9%87%8A"><span class="nav-number">6.3.</span> <span class="nav-text">3:文件解释</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%EF%BC%9A%E4%BD%BF%E7%94%A8launch%E6%96%87%E4%BB%B6"><span class="nav-number">6.4.</span> <span class="nav-text">4：使用launch文件</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jason Qi</p>
  <div class="site-description" itemprop="description">Life is short, make everyday count!</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/onlyQF" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;onlyQF" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1601099263@qq.com" title="E-Mail → mailto:1601099263@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/yourname" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/yourname" title="Google → https:&#x2F;&#x2F;plus.google.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i>Google</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/yourname" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://youtube.com/yourname" title="YouTube → https:&#x2F;&#x2F;youtube.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://onlyqf.github.io/2022/06/01/ROS2-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason Qi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason Qi's Blog">
      <meta itemprop="description" content="Life is short, make everyday count!">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ROS2 Notes | Jason Qi's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ROS2 Notes
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-06-02 10:44:57 / Modified: 22:45:29" itemprop="dateCreated datePublished" datetime="2022-06-02T10:44:57+08:00">2022-06-02</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="一：debugger-c-ros2-in-vscode"><a href="#一：debugger-c-ros2-in-vscode" class="headerlink" title="一：debugger c++ ros2  in vscode"></a>一：debugger c++ ros2  in vscode</h1><p>a method to debug a C++ node usign VSCode on ROS2 Foxy (Ubuntu).</p>
<ol>
<li>Compile your C++ package with the symbols:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=RelWithDebInfo</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Run the GDB Server in a localhost:port</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ros2 run --prefix &#x27;gdbserver localhost:3000&#x27; package_name executable_name</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="3">
<li><p>Open VSCode on your workspace, open the debug section (side bar) and create new launch.json configuration file for debugging. Configure as follow:</p>
<p> {<br> “version”: “0.2.0”,<br> “configurations”: [<br> {<br>     “name”: “C++ Debugger”,<br>     “request”: “launch”,<br>     “type”: “cppdbg”,<br>     “miDebuggerServerAddress”: “localhost:3000”,<br>     “cwd”: “&#x2F;“,<br>     “program”: “[build-path-executable]”<br> }<br> ]</p>
</li>
</ol>
<p>}</p>
<p>Change [build-path-executable] by your executable build file. You can find this path on the console when you launch the server.</p>
<ol start="4">
<li>Run the debugger and use VSCode to debug your code.</li>
</ol>
<p>Here is a more detail explanation <a target="_blank" rel="noopener" href="https://gist.github.com/JADC362/a4425">https://gist.github.com/JADC362/a4425</a>…</p>
<p>#二：简单的ros2的发布节点撰写</p>
<h2 id="1：-编写发布者节点代码"><a href="#1：-编写发布者节点代码" class="headerlink" title="1： 编写发布者节点代码"></a>1： 编写发布者节点代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;chrono&gt;</span><br><span class="line">#include &lt;functional&gt;</span><br><span class="line">#include &lt;memory&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &quot;rclcpp/rclcpp.hpp&quot;</span><br><span class="line">#include &quot;std_msgs/msg/string.hpp&quot;</span><br><span class="line"></span><br><span class="line">using namespace std::chrono_literals;</span><br><span class="line"></span><br><span class="line">/* This example creates a subclass of Node and uses std::bind() to register a</span><br><span class="line">* member function as a callback from the timer. */</span><br><span class="line"></span><br><span class="line">class MinimalPublisher : public rclcpp::Node</span><br><span class="line">&#123;</span><br><span class="line">  public:</span><br><span class="line">    MinimalPublisher()</span><br><span class="line">    : Node(&quot;minimal_publisher&quot;), count_(0)</span><br><span class="line">    &#123;</span><br><span class="line">      publisher_ = this-&gt;create_publisher&lt;std_msgs::msg::String&gt;(&quot;topic&quot;, 10);</span><br><span class="line">      timer_ = this-&gt;create_wall_timer(</span><br><span class="line">      500ms, std::bind(&amp;MinimalPublisher::timer_callback, this));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  private:</span><br><span class="line">    void timer_callback()</span><br><span class="line">    &#123;</span><br><span class="line">      auto message = std_msgs::msg::String();</span><br><span class="line">      message.data = &quot;Hello, world! &quot; + std::to_string(count_++);</span><br><span class="line">      RCLCPP_INFO(this-&gt;get_logger(), &quot;Publishing: &#x27;%s&#x27;&quot;, message.data.c_str());</span><br><span class="line">      publisher_-&gt;publish(message);</span><br><span class="line">    &#125;</span><br><span class="line">    rclcpp::TimerBase::SharedPtr timer_;</span><br><span class="line">    rclcpp::Publisher&lt;std_msgs::msg::String&gt;::SharedPtr publisher_;</span><br><span class="line">    size_t count_;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">int main(int argc, char * argv[])</span><br><span class="line">&#123;</span><br><span class="line">  rclcpp::init(argc, argv);</span><br><span class="line">  rclcpp::spin(std::make_shared&lt;MinimalPublisher&gt;());</span><br><span class="line">  rclcpp::shutdown();</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2：修改Cmakelists-txt和packageXML文件"><a href="#2：修改Cmakelists-txt和packageXML文件" class="headerlink" title="2：修改Cmakelists.txt和packageXML文件"></a>2：修改Cmakelists.txt和packageXML文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;depend&gt;rclcpp&lt;/depend&gt;</span><br><span class="line">&lt;depend&gt;std_msgs&lt;/depend&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">find_package(rclcpp REQUIRED)</span><br><span class="line">find_package(std_msgs REQUIRED)</span><br><span class="line"></span><br><span class="line">add_executable(talker src/publisher_member_function.cpp)</span><br><span class="line">ament_target_dependencies(talker rclcpp std_msgs)</span><br></pre></td></tr></table></figure>

<p>Finally, add the install(TARGETS…) section so ros2 run can find your executable:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">install(TARGETS</span><br><span class="line">  talker</span><br><span class="line">  DESTINATION lib/$&#123;PROJECT_NAME&#125;)</span><br></pre></td></tr></table></figure>

<p>最终的Cmakelists.txt的文件如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.5)</span><br><span class="line">project(cpp_pubsub)</span><br><span class="line"></span><br><span class="line"># Default to C++14</span><br><span class="line">if(NOT CMAKE_CXX_STANDARD)</span><br><span class="line">  set(CMAKE_CXX_STANDARD 14)</span><br><span class="line">endif()</span><br><span class="line"></span><br><span class="line">if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES &quot;Clang&quot;)</span><br><span class="line">  add_compile_options(-Wall -Wextra -Wpedantic)</span><br><span class="line">endif()</span><br><span class="line"></span><br><span class="line">find_package(ament_cmake REQUIRED)</span><br><span class="line">find_package(rclcpp REQUIRED)</span><br><span class="line">find_package(std_msgs REQUIRED)</span><br><span class="line"></span><br><span class="line">add_executable(talker src/publisher_member_function.cpp)</span><br><span class="line">ament_target_dependencies(talker rclcpp std_msgs)</span><br><span class="line"></span><br><span class="line">install(TARGETS</span><br><span class="line">  talker</span><br><span class="line">  DESTINATION lib/$&#123;PROJECT_NAME&#125;)</span><br><span class="line"></span><br><span class="line">ament_package()</span><br></pre></td></tr></table></figure>

<h1 id="三：简单的ros2订阅者节点的撰写"><a href="#三：简单的ros2订阅者节点的撰写" class="headerlink" title="三：简单的ros2订阅者节点的撰写"></a>三：简单的ros2订阅者节点的撰写</h1><h2 id="1：编写订阅者节点代码"><a href="#1：编写订阅者节点代码" class="headerlink" title="1：编写订阅者节点代码"></a>1：编写订阅者节点代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;memory&gt;</span><br><span class="line"></span><br><span class="line">#include &quot;rclcpp/rclcpp.hpp&quot;</span><br><span class="line">#include &quot;std_msgs/msg/string.hpp&quot;</span><br><span class="line">using std::placeholders::_1;</span><br><span class="line"></span><br><span class="line">class MinimalSubscriber : public rclcpp::Node</span><br><span class="line">&#123;</span><br><span class="line">  public:</span><br><span class="line">    MinimalSubscriber()</span><br><span class="line">    : Node(&quot;minimal_subscriber&quot;)</span><br><span class="line">    &#123;</span><br><span class="line">      subscription_ = this-&gt;create_subscription&lt;std_msgs::msg::String&gt;(</span><br><span class="line">      &quot;topic&quot;, 10, std::bind(&amp;MinimalSubscriber::topic_callback, this, _1));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  private:</span><br><span class="line">    void topic_callback(const std_msgs::msg::String::SharedPtr msg) const</span><br><span class="line">    &#123;</span><br><span class="line">      RCLCPP_INFO(this-&gt;get_logger(), &quot;I heard: &#x27;%s&#x27;&quot;, msg-&gt;data.c_str());</span><br><span class="line">    &#125;</span><br><span class="line">    rclcpp::Subscription&lt;std_msgs::msg::String&gt;::SharedPtr subscription_;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">int main(int argc, char * argv[])</span><br><span class="line">&#123;</span><br><span class="line">  rclcpp::init(argc, argv);</span><br><span class="line">  rclcpp::spin(std::make_shared&lt;MinimalSubscriber&gt;());</span><br><span class="line">  rclcpp::shutdown();</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2：修改Cmakelists-txt和packageXML文件-1"><a href="#2：修改Cmakelists-txt和packageXML文件-1" class="headerlink" title="2：修改Cmakelists.txt和packageXML文件"></a>2：修改Cmakelists.txt和packageXML文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add_executable(listener src/subscriber_member_function.cpp)</span><br><span class="line">ament_target_dependencies(listener rclcpp std_msgs)</span><br><span class="line"></span><br><span class="line">install(TARGETS</span><br><span class="line">  talker</span><br><span class="line">  listener</span><br><span class="line">  DESTINATION lib/$&#123;PROJECT_NAME&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="3：-注："><a href="#3：-注：" class="headerlink" title="3： 注："></a>3： 注：</h2><p>一个功能包内可以有多个节点；<br>一个节点可以既往多个topic发布消息，也可以订阅多个topic的并做回调函数的处理；</p>
<h1 id="四：编写-srv文件，实现服务类型"><a href="#四：编写-srv文件，实现服务类型" class="headerlink" title="四：编写.srv文件，实现服务类型"></a>四：编写.srv文件，实现服务类型</h1><h2 id="1：-srv文件格式"><a href="#1：-srv文件格式" class="headerlink" title="1： srv文件格式"></a>1： srv文件格式</h2><p> int a<br> int b<br> &#x2F;—<br> int c<br> a b为服务接受的参数，c为返回的值；</p>
<h2 id="2：修改Cmakelists-txt和packageXML文件-2"><a href="#2：修改Cmakelists-txt和packageXML文件-2" class="headerlink" title="2：修改Cmakelists.txt和packageXML文件"></a>2：修改Cmakelists.txt和packageXML文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dependencies rclcpp example_interfaces</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3：-srv节点的代码的编写"><a href="#3：-srv节点的代码的编写" class="headerlink" title="3： srv节点的代码的编写"></a>3： srv节点的代码的编写</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;rclcpp/rclcpp.hpp&quot;</span><br><span class="line">#include &quot;example_interfaces/srv/add_two_ints.hpp&quot;//包含头文件</span><br><span class="line"></span><br><span class="line">#include &lt;memory&gt;</span><br><span class="line"></span><br><span class="line">void add(const std::shared_ptr&lt;example_interfaces::srv::AddTwoInts::Request&gt; request,</span><br><span class="line">          std::shared_ptr&lt;example_interfaces::srv::AddTwoInts::Response&gt;      response)</span><br><span class="line">&#123;</span><br><span class="line">  response-&gt;sum = request-&gt;a + request-&gt;b;</span><br><span class="line">  RCLCPP_INFO(rclcpp::get_logger(&quot;rclcpp&quot;), &quot;Incoming request\na: %ld&quot; &quot; b: %ld&quot;,</span><br><span class="line">                request-&gt;a, request-&gt;b);</span><br><span class="line">  RCLCPP_INFO(rclcpp::get_logger(&quot;rclcpp&quot;), &quot;sending back response: [%ld]&quot;, (long int)response-&gt;sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv)</span><br><span class="line">&#123;</span><br><span class="line">  rclcpp::init(argc, argv);</span><br><span class="line"></span><br><span class="line">  std::shared_ptr&lt;rclcpp::Node&gt; node = rclcpp::Node::make_shared(&quot;add_two_ints_server&quot;);</span><br><span class="line"></span><br><span class="line">  rclcpp::Service&lt;example_interfaces::srv::AddTwoInts&gt;::SharedPtr service =</span><br><span class="line">    node-&gt;create_service&lt;example_interfaces::srv::AddTwoInts&gt;(&quot;add_two_ints&quot;, &amp;add);</span><br><span class="line"></span><br><span class="line">  RCLCPP_INFO(rclcpp::get_logger(&quot;rclcpp&quot;), &quot;Ready to add two ints.&quot;);</span><br><span class="line"></span><br><span class="line">  rclcpp::spin(node);</span><br><span class="line">  rclcpp::shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4：client端代码的编写"><a href="#4：client端代码的编写" class="headerlink" title="4：client端代码的编写"></a>4：client端代码的编写</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;rclcpp/rclcpp.hpp&quot;</span><br><span class="line">#include &quot;example_interfaces/srv/add_two_ints.hpp&quot;</span><br><span class="line"></span><br><span class="line">#include &lt;chrono&gt;</span><br><span class="line">#include &lt;cstdlib&gt;</span><br><span class="line">#include &lt;memory&gt;</span><br><span class="line"></span><br><span class="line">using namespace std::chrono_literals;</span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv)</span><br><span class="line">&#123;</span><br><span class="line">  rclcpp::init(argc, argv);</span><br><span class="line"></span><br><span class="line">  if (argc != 3) &#123;</span><br><span class="line">      RCLCPP_INFO(rclcpp::get_logger(&quot;rclcpp&quot;), &quot;usage: add_two_ints_client X Y&quot;);</span><br><span class="line">      return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  std::shared_ptr&lt;rclcpp::Node&gt; node = rclcpp::Node::make_shared(&quot;add_two_ints_client&quot;);</span><br><span class="line">  rclcpp::Client&lt;example_interfaces::srv::AddTwoInts&gt;::SharedPtr client =</span><br><span class="line">    node-&gt;create_client&lt;example_interfaces::srv::AddTwoInts&gt;(&quot;add_two_ints&quot;);</span><br><span class="line"></span><br><span class="line">  auto request = std::make_shared&lt;example_interfaces::srv::AddTwoInts::Request&gt;();</span><br><span class="line">  request-&gt;a = atoll(argv[1]);</span><br><span class="line">  request-&gt;b = atoll(argv[2]);</span><br><span class="line"></span><br><span class="line">  while (!client-&gt;wait_for_service(1s)) &#123;</span><br><span class="line">    if (!rclcpp::ok()) &#123;</span><br><span class="line">      RCLCPP_ERROR(rclcpp::get_logger(&quot;rclcpp&quot;), &quot;Interrupted while waiting for the service. Exiting.&quot;);</span><br><span class="line">      return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    RCLCPP_INFO(rclcpp::get_logger(&quot;rclcpp&quot;), &quot;service not available, waiting again...&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  auto result = client-&gt;async_send_request(request);</span><br><span class="line">  // Wait for the result.</span><br><span class="line">  if (rclcpp::spin_until_future_complete(node, result) ==</span><br><span class="line">    rclcpp::FutureReturnCode::SUCCESS)</span><br><span class="line">  &#123;</span><br><span class="line">    RCLCPP_INFO(rclcpp::get_logger(&quot;rclcpp&quot;), &quot;Sum: %ld&quot;, result.get()-&gt;sum);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    RCLCPP_ERROR(rclcpp::get_logger(&quot;rclcpp&quot;), &quot;Failed to call service add_two_ints&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  rclcpp::shutdown();</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5：Cmakelsts-txt和packageXML文件的修改"><a href="#5：Cmakelsts-txt和packageXML文件的修改" class="headerlink" title="5：Cmakelsts.txt和packageXML文件的修改"></a>5：Cmakelsts.txt和packageXML文件的修改</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.5)</span><br><span class="line">project(cpp_srvcli)</span><br><span class="line"></span><br><span class="line">find_package(ament_cmake REQUIRED)</span><br><span class="line">find_package(rclcpp REQUIRED)</span><br><span class="line">find_package(example_interfaces REQUIRED)</span><br><span class="line"></span><br><span class="line">add_executable(server src/add_two_ints_server.cpp)</span><br><span class="line">ament_target_dependencies(server</span><br><span class="line">  rclcpp example_interfaces)</span><br><span class="line"></span><br><span class="line">add_executable(client src/add_two_ints_client.cpp)</span><br><span class="line">ament_target_dependencies(client</span><br><span class="line">  rclcpp example_interfaces)</span><br><span class="line"></span><br><span class="line">install(TARGETS</span><br><span class="line">  server</span><br><span class="line">  client</span><br><span class="line">  DESTINATION lib/$&#123;PROJECT_NAME&#125;)</span><br><span class="line"></span><br><span class="line">ament_package()</span><br></pre></td></tr></table></figure>

<h1 id="五：-msg文件的编写"><a href="#五：-msg文件的编写" class="headerlink" title="五：.msg文件的编写"></a>五：.msg文件的编写</h1><h2 id="1：在WS下src"><a href="#1：在WS下src" class="headerlink" title="1：在WS下src;"></a>1：在WS下src;</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd workspace/src</span><br></pre></td></tr></table></figure>
<h2 id="2-创建msg包，新建msg文件夹"><a href="#2-创建msg包，新建msg文件夹" class="headerlink" title="2:创建msg包，新建msg文件夹"></a>2:创建msg包，新建msg文件夹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg create --build-type ament_cmake more_interfaces</span><br><span class="line">   mkdir more_interfaces/msg</span><br></pre></td></tr></table></figure>
<h2 id="3-创建msg文件"><a href="#3-创建msg文件" class="headerlink" title="3:创建msg文件"></a>3:创建msg文件</h2><p>Inside more_interfaces&#x2F;msg, create a new file AddressBook.msg</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bool FEMALE=true</span><br><span class="line">bool MALE=false</span><br><span class="line"></span><br><span class="line">string first_name</span><br><span class="line">string last_name</span><br><span class="line">bool gender</span><br><span class="line">uint8 age</span><br><span class="line">string address</span><br></pre></td></tr></table></figure>

<h2 id="4：修改Cmakelists和packageXML文件"><a href="#4：修改Cmakelists和packageXML文件" class="headerlink" title="4：修改Cmakelists和packageXML文件"></a>4：修改Cmakelists和packageXML文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;buildtool_depend&gt;rosidl_default_generators&lt;/buildtool_depend&gt;</span><br><span class="line"></span><br><span class="line">&lt;exec_depend&gt;rosidl_default_runtime&lt;/exec_depend&gt;</span><br><span class="line"></span><br><span class="line">&lt;member_of_group&gt;rosidl_interface_packages&lt;/member_of_group&gt;</span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">find_package(rosidl_default_generators REQUIRED)</span><br><span class="line"></span><br><span class="line">set(msg_files</span><br><span class="line">  &quot;msg/AddressBook.msg&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">rosidl_generate_interfaces($&#123;PROJECT_NAME&#125;</span><br><span class="line">  $&#123;msg_files&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">ament_export_dependencies(rosidl_default_runtime)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="5：在其他包里面使用自定义msg"><a href="#5：在其他包里面使用自定义msg" class="headerlink" title="5：在其他包里面使用自定义msg"></a>5：在其他包里面使用自定义msg</h2><p>1：在功能包下，在所创建的msg文件夹下，创建src文件夹用来放置源文件<br>2：在main.cpp文件里包含头文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#include “packagename/msg/msg.hpp” //为小写字母</span><br><span class="line"></span><br><span class="line">在用具体消息类创建对象时： packagename::msg::msgname obj;//msgname为原始定义的msgname为大写开头</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="六：创建包依赖其他包举例"><a href="#六：创建包依赖其他包举例" class="headerlink" title="六：创建包依赖其他包举例"></a>六：创建包依赖其他包举例</h1><h2 id="1-：文件组织分布"><a href="#1-：文件组织分布" class="headerlink" title="1 ：文件组织分布"></a>1 ：文件组织分布</h2><p>![alt text](&#x2F;home&#x2F;qifei&#x2F;Pictures&#x2F;Screenshot from 2022-05-04 01-27-00.png)<br>![](&#x2F;home&#x2F;qifei&#x2F;Pictures&#x2F;Screenshot from 2022-05-04 01-28-16.png)</p>
<h2 id="2-sm-node-包依赖其他四个包"><a href="#2-sm-node-包依赖其他四个包" class="headerlink" title="2 :sm_node 包依赖其他四个包"></a>2 :sm_node 包依赖其他四个包</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg create sm_node --dependencies cem_park vehicle_msgs cem_diagnositi_msgs </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这样就可以在sm_node包里面使用其他几个包里面的消息类型等</p>
<h1 id="七：launch-文件使用"><a href="#七：launch-文件使用" class="headerlink" title="七：launch 文件使用"></a>七：launch 文件使用</h1><h2 id="1：Create-a-new-directory-to-store-your-launch-file"><a href="#1：Create-a-new-directory-to-store-your-launch-file" class="headerlink" title="1：Create a new directory to store your launch file:"></a>1：Create a new directory to store your launch file:</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir launch</span><br></pre></td></tr></table></figure>

<h2 id="2：创建launch-py文件"><a href="#2：创建launch-py文件" class="headerlink" title="2：创建launch.py文件"></a>2：创建launch.py文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch launch/test_launch.py</span><br></pre></td></tr></table></figure>

<h2 id="3-文件解释"><a href="#3-文件解释" class="headerlink" title="3:文件解释"></a>3:文件解释</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">from launch import LaunchDescription</span><br><span class="line">from launch_ros.actions import Node</span><br><span class="line"></span><br><span class="line">def generate_launch_description():</span><br><span class="line">    return LaunchDescription([</span><br><span class="line">        Node(</span><br><span class="line">            package=&#x27;turtlesim&#x27;,</span><br><span class="line">            namespace=&#x27;turtlesim1&#x27;,</span><br><span class="line">            executable=&#x27;turtlesim_node&#x27;,</span><br><span class="line">            name=&#x27;sim&#x27;</span><br><span class="line">        ),</span><br><span class="line">        Node(</span><br><span class="line">            package=&#x27;turtlesim&#x27;,</span><br><span class="line">            namespace=&#x27;turtlesim2&#x27;,</span><br><span class="line">            executable=&#x27;turtlesim_node&#x27;,</span><br><span class="line">            name=&#x27;sim&#x27;</span><br><span class="line">        ),</span><br><span class="line">        Node(</span><br><span class="line">            package=&#x27;turtlesim&#x27;,</span><br><span class="line">            executable=&#x27;mimic&#x27;,</span><br><span class="line">            name=&#x27;mimic&#x27;,</span><br><span class="line">            remappings=[</span><br><span class="line">                (&#x27;/input/pose&#x27;, &#x27;/turtlesim1/turtle1/pose&#x27;),</span><br><span class="line">                (&#x27;/output/cmd_vel&#x27;, &#x27;/turtlesim2/turtle1/cmd_vel&#x27;),</span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line">    ])</span><br></pre></td></tr></table></figure>

<h2 id="4：使用launch文件"><a href="#4：使用launch文件" class="headerlink" title="4：使用launch文件"></a>4：使用launch文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd launch</span><br><span class="line">ros2 launch turtlesim_mimic_launch.py</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/06/01/global-variables-in-c-cpp/" rel="prev" title="global variables in c/cpp">
                  <i class="fa fa-chevron-left"></i> global variables in c/cpp
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/06/02/About%20me/" rel="next" title="About me">
                  About me <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason Qi</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  





</body>
</html>
